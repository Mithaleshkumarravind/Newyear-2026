<script>
// ---------- 3D CARD TILT ----------
const card = document.getElementById("card");
document.addEventListener("mousemove", e => {
  let x = (window.innerWidth / 2 - e.clientX) / 30;
  let y = (window.innerHeight / 2 - e.clientY) / 30;
  card.style.transform = `rotateY(${x}deg) rotateX(${y}deg)`;
});

// ---------- FLOATING DOTS ----------
for (let i = 0; i < 50; i++) {
  let d = document.createElement("div");
  d.className = "dot";
  d.style.left = Math.random() * 100 + "%";
  d.style.animationDelay = Math.random() * 7 + "s";
  document.body.appendChild(d);
}

// ---------- FIREWORKS ----------
const canvas = document.getElementById("fw");
const ctx = canvas.getContext("2d");
canvas.width = innerWidth;
canvas.height = innerHeight;
let parts = [];

function blast() {
  let x = Math.random() * canvas.width;
  let y = Math.random() * canvas.height / 2;
  for (let i = 0; i < 120; i++) {
    parts.push({
      x, y,
      vx: (Math.random() - 0.5) * 8,
      vy: (Math.random() - 0.5) * 8,
      life: 120,
      col: `hsl(${Math.random() * 360},100%,60%)`
    });
  }
}

function animate() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  parts.forEach((p, i) => {
    p.x += p.vx;
    p.y += p.vy;
    p.life--;
    ctx.fillStyle = p.col;
    ctx.beginPath();
    ctx.arc(p.x, p.y, 2.5, 0, Math.PI * 2);
    ctx.fill();
    if (p.life <= 0) parts.splice(i, 1);
  });
  requestAnimationFrame(animate);
}
setInterval(blast, 800);
animate();

// ---------- FIXED GENERATE FUNCTION ----------
function make() {
  const nameInput = document.getElementById("name");
  const photoInput = document.getElementById("photo");
  const res = document.getElementById("res");
  const img = document.getElementById("img");
  const wish = document.getElementById("wish");

  if (nameInput.value.trim() === "") {
    alert("Pehle naam likho ðŸ‘‡");
    return;
  }

  if (!photoInput.files || !photoInput.files[0]) {
    alert("Photo select karo ðŸ“¸");
    return;
  }

  const reader = new FileReader();
  reader.onload = function () {
    img.src = reader.result;
    wish.innerHTML = `âœ¨ Happy New Year <span style="color:#00ffff">${nameInput.value}</span> âœ¨<br>3D Fireworks Vibes ðŸŽ†`;
    res.style.display = "block";
    blast();
  };
  reader.readAsDataURL(photoInput.files[0]);
}
</script>
